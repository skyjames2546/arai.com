<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ | Arai Football</title>
<style>
  body {
    margin: 0;
    font-family: 'Sarabun', sans-serif;
    background-color: #111;
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 40px 20px;
    text-align: center;
  }
  h1 {
    color: #ffd700;
    font-size: 2.5em;
    margin-bottom: 20px;
    text-shadow: 1px 1px 5px rgba(0,0,0,0.4);
  }
  .customer-info {
    background-color: #1c1c1c;
    padding: 20px 30px;
    border-radius: 15px;
    margin-bottom: 30px;
    border: 2px solid #ffd700;
    max-width: 500px;
    width: 100%;
  }
  .customer-info p {
    font-size: 1.1em;
    margin: 10px 0;
    color: #ffeb3b;
  }
  .thank-img {
    max-width: 350px;
    width: 100%;
    border-radius: 20px;
    border: 4px solid #ffeb3b;
    box-shadow: 0 0 15px rgba(255,215,0,0.3);
    margin-bottom: 30px;
  }
  .qr-img {
    max-width: 200px;
    width: 100%;
    margin-top: 15px;
    border: 3px solid #ffeb3b;
    border-radius: 12px;
    box-shadow: 0 0 10px rgba(255,235,59,0.3);
  }
  footer {
    margin-top: 40px;
    color: #ffeb3b;
  }
  .home-btn {
    padding: 12px 25px;
    font-size: 1.1em;
    background: linear-gradient(90deg, #ffeb3b, #ffc107);
    border: none;
    border-radius: 10px;
    cursor: pointer;
    color: #111;
    font-weight: bold;
    transition: 0.3s ease;
    text-shadow: 1px 1px 5px rgba(0,0,0,0.3);
    margin-top: 10px;
  }
  .home-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 0 12px rgba(255,215,0,0.4);
  }
</style>
</head>
<body>

<h1>üôè ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠!</h1>

<!-- ‡∏£‡∏π‡∏õ‡∏´‡∏•‡∏±‡∏Å -->
<img src="thankyou-image.jpg" alt="‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠" class="thank-img" />

<div class="customer-info" id="customerDetails">
  <p><strong>‡∏ä‡∏∑‡πà‡∏≠:</strong> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</p>
  <p><strong>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</strong> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</p>
  <p><strong>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå:</strong> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</p>
  <p><strong>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°:</strong> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</p>
  <img src="QR.jpg" alt="QR.jpg" class="qr-img" />
  <p style="margin-top: 15px; color: #ccc; font-size: 0.95em;">
    üìå ‡∏´‡∏≤‡∏Å‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏à‡πâ‡∏á‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏•‡∏Ç‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ ‡πÑ‡∏õ‡∏¢‡∏±‡∏á 
    <a href="https://line.me/ti/p/8MAEZ9k49X" target="_blank" style="color:#ffeb3b; text-decoration:none; font-weight:bold;">
      LINE ‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô
    </a>
  </p>
</div>

<button class="home-btn" onclick="window.location.href='checkout.html'">‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏≠‡∏≤‡∏ó‡πå</button>
<button class="home-btn" id="downloadPDFBtn">üìÑ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à PDF</button>

<footer>¬© 2025 ‡∏≠‡∏≤‡∏£‡∏≤‡∏¢ ‡∏ü‡∏∏‡∏ï‡∏ö‡∏≠‡∏•</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
const { jsPDF } = window.jspdf;

// ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
const customerData = JSON.parse(localStorage.getItem("lastCustomer")) || {name:"‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏∞‡∏ö‡∏∏", address:"-", phone:"-"};
const cart = JSON.parse(localStorage.getItem("cart")) || [];

let total = 0;
cart.forEach(item => total += parseFloat(item.price)*item.qty);

function generateCustomerID(){ return Math.floor(100000 + Math.random()*900000); }
const customerID = generateCustomerID();

const details = document.getElementById("customerDetails");
details.innerHTML = `
  <p><strong>‡πÄ‡∏•‡∏Ç‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:</strong> ${customerID}</p>
  <p><strong>‡∏ä‡∏∑‡πà‡∏≠:</strong> ${customerData.name}</p>
  <p><strong>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</strong> ${customerData.address}</p>
  <p><strong>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå:</strong> ${customerData.phone}</p>
  <p><strong>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</strong> ${total.toLocaleString()} ‡∏ö‡∏≤‡∏ó</p>
  <img src="QR.jpg" alt="QR Code" class="qr-img" />
  <p style="margin-top: 15px; color: #ccc; font-size: 0.95em;">
    üìå ‡∏´‡∏≤‡∏Å‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏à‡πâ‡∏á‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏•‡∏Ç‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (${customerID}) ‡πÑ‡∏õ‡∏¢‡∏±‡∏á 
    <a href="https://line.me/ti/p/8MAEZ9k49X" target="_blank" style="color:#ffeb3b; text-decoration:none; font-weight:bold;">LINE ‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô</a>
  </p>
`;

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏à‡∏≤‡∏Å <img> element
function getImageData(imgElement){
  return new Promise((resolve,reject)=>{
    const img = new Image();
    img.crossOrigin = "Anonymous";
    img.onload = ()=>{
      const canvas = document.createElement("canvas");
      canvas.width = img.width;
      canvas.height = img.height;
      const ctx = canvas.getContext("2d");
      ctx.drawImage(img,0,0);
      resolve(canvas.toDataURL("image/png"));
    };
    img.onerror = reject;
    img.src = imgElement.src;
  });
}

document.getElementById("downloadPDFBtn").addEventListener("click", async ()=>{
  try{
    const doc = new jsPDF();
    let y=20;

    const logoImg = document.querySelector('.thank-img'); // ‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡∏´‡∏•‡∏±‡∏Å
    const qrImg = document.querySelector('.qr-img');

    const logoData = await getImageData(logoImg);
    const qrData = await getImageData(qrImg);

    // ‡πÉ‡∏™‡πà‡∏£‡∏π‡∏õ‡∏´‡∏•‡∏±‡∏Å‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á
    doc.addImage(logoData,'PNG',30,y,150,75);
    y+=80;

    doc.setFontSize(18);
    doc.setTextColor(255,215,0);
    doc.text("‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô Arai Football",105,y,{align:'center'});
    y+=15;

    doc.setFontSize(12);
    doc.setTextColor(0,0,0);
    doc.text(`‡πÄ‡∏•‡∏Ç‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ${customerID}`,20,y); y+=8;
    doc.text(`‡∏ä‡∏∑‡πà‡∏≠: ${customerData.name}`,20,y); y+=8;
    doc.text(`‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà: ${customerData.address}`,20,y); y+=8;
    doc.text(`‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå: ${customerData.phone}`,20,y); y+=10;

    // ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
    doc.setFillColor(255,215,0);
    doc.rect(20, y, 170, 8, 'F'); // header background
    doc.setTextColor(0,0,0);
    doc.text("‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤",22,y+6);
    doc.text("‡∏Ç‡∏ô‡∏≤‡∏î",90,y+6);
    doc.text("‡∏à‡∏≥‡∏ô‡∏ß‡∏ô",120,y+6);
    doc.text("‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏ä‡∏¥‡πâ‡∏ô",145,y+6);
    doc.text("‡∏£‡∏ß‡∏°",175,y+6,{align:'right'});
    y+=10;

    cart.forEach(item=>{
      doc.setFillColor(28,28,28);
      doc.rect(20,y,170,8,'F');
      doc.setTextColor(255,215,0);
      doc.text(item.name,22,y+6);
      doc.text(item.size,90,y+6);
      doc.text(item.qty.toString(),120,y+6);
      doc.text(item.price.toLocaleString(),145,y+6);
      doc.text((item.price*item.qty).toLocaleString(),175,y+6,{align:'right'});
      y+=8;
    });

    y+=5;
    doc.setFontSize(14);
    doc.setTextColor(0,0,255);
    doc.text(`‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ${total.toLocaleString()} ‡∏ö‡∏≤‡∏ó`,20,y); y+=10;

    // ‡πÉ‡∏™‡πà QR Code
    doc.addImage(qrData,'PNG',150,20,40,40);

    doc.save(`receipt_${customerID}.pdf`);
  }catch(err){
    alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á PDF: "+err);
  }
});
</script>
</body>
</html>
